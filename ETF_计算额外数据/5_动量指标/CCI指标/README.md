# CCI指标 (顺势指标)

## 指标概述
CCI (Commodity Channel Index) 由唐纳德·兰伯特开发，用于识别新趋势的开始和结束。CCI通过测量价格偏离其统计平均值的程度来判断买卖时机。

## 包含指标

### 核心CCI指标
- **CCI14**: 14日顺势指标 - 标准周期
- **CCI20**: 20日顺势指标 - 月度周期
- **CCI30**: 30日顺势指标 - 长期周期

### 衍生指标
- **CCI_Signal**: CCI信号标识
- **CCI_Trend**: CCI趋势方向
- **CCI_Divergence**: CCI背离信号

## 计算公式

### 典型价格
```
TP = (最高价 + 最低价 + 收盘价) / 3
```

### CCI计算
```
SMA = TP的N日简单移动平均
MD = |TP - SMA|的N日简单移动平均 (平均绝对偏差)
CCI = (TP - SMA) / (0.015 × MD)

其中：
0.015是兰伯特常数，用于使约75%的CCI值在-100到+100之间
```

### 平均绝对偏差
```
MD = Σ|TPi - SMA| / N
这比标准差计算更简单，减少计算复杂度
```

## 应用策略

### 1. 超买超卖策略
- **CCI > +100**: 超买区域，考虑卖出
- **CCI < -100**: 超卖区域，考虑买入
- **CCI ±200**: 极端超买超卖

### 2. 零轴策略
- **CCI > 0**: 价格高于平均值，偏强
- **CCI < 0**: 价格低于平均值，偏弱
- **穿越零轴**: 趋势转换信号

### 3. 趋势跟踪策略
- **CCI持续>+100**: 强势上涨趋势
- **CCI持续<-100**: 强势下跌趋势
- **CCI回归±100**: 趋势可能结束

### 4. 背离分析
- **顶背离**: 价格创新高，CCI不创新高
- **底背离**: 价格创新低，CCI不创新低

## 信号强度分级

### 强信号
- **极值突破**: CCI突破±200
- **背离确认**: 明显的价格指标背离
- **趋势延续**: CCI长期保持在±100之外

### 中等信号
- **标准突破**: CCI突破±100
- **零轴穿越**: CCI穿越零轴
- **回归信号**: 从极值区域回归

### 弱信号
- **区间震荡**: CCI在-100到+100区间震荡
- **无明确方向**: CCI横盘整理

## 参数设置建议

### 短期CCI (CCI10)
- **特点**: 敏感度高，信号频繁
- **适用**: 短线交易
- **阈值**: ±80

### 标准CCI (CCI14)
- **特点**: 经典参数，平衡性好
- **适用**: 一般交易策略
- **阈值**: ±100

### 长期CCI (CCI20/CCI30)
- **特点**: 稳定性好，假信号少
- **适用**: 中长期投资
- **阈值**: ±100

## 实战应用技巧

### 1. 多级信号系统
```python
def cci_signal_strength(cci):
    if cci > 200:
        return "极度超买"
    elif cci > 100:
        return "超买"
    elif cci > 0:
        return "偏强"
    elif cci > -100:
        return "偏弱"
    elif cci > -200:
        return "超卖"
    else:
        return "极度超卖"
```

### 2. 趋势确认系统
```python
def cci_trend_confirmation(cci, period=5):
    # 检查CCI是否持续在±100之外
    if all(cci[-period:] > 100):
        return "强势上涨趋势"
    elif all(cci[-period:] < -100):
        return "强势下跌趋势"
    else:
        return "无明确趋势"
```

### 3. 入场信号识别
```python
def cci_entry_signals(cci, prices):
    current_cci = cci[-1]
    prev_cci = cci[-2]
    
    # 买入信号：从超卖区域向上突破-100
    if current_cci > -100 and prev_cci <= -100:
        return "买入信号"
    
    # 卖出信号：从超买区域向下突破+100  
    elif current_cci < 100 and prev_cci >= 100:
        return "卖出信号"
    
    return "等待信号"
```

## 市场环境适应性

### 趋势市场 ✅
- **优势**: CCI在趋势市场表现出色
- **策略**: 趋势跟踪，持有至CCI回归
- **特点**: 能够捕捉强势趋势

### 震荡市场 ⚠️
- **问题**: 可能产生较多假信号
- **解决**: 结合其他指标过滤
- **调整**: 缩小参数提高敏感性

### 突破行情 ✅
- **确认**: CCI突破极值确认突破有效
- **验证**: 配合成交量验证

## 与其他指标对比

### CCI vs RSI
- **敏感性**: CCI通常比RSI更敏感
- **无边界**: CCI无固定上下边界
- **计算**: CCI基于典型价格，RSI基于收盘价

### CCI vs MACD
- **速度**: CCI反应更快
- **趋势**: MACD更适合趋势确认
- **信号**: CCI超买超卖信号更明确

## 组合使用建议

### CCI + 移动平均线
- **趋势过滤**: 用MA确定主趋势方向
- **信号过滤**: 只在趋势方向操作

### CCI + 成交量
- **信号验证**: CCI极值需要成交量配合
- **突破确认**: 量价配合的CCI突破

### CCI + 布林带
- **位置确认**: 结合布林带位置分析
- **双重验证**: 两个指标同时发出信号

## 常见陷阱

### 1. 过度依赖极值
- **问题**: 认为CCI>200必然反转
- **解决**: 结合趋势分析

### 2. 忽略市场环境
- **问题**: 不区分趋势市和震荡市
- **解决**: 根据市场状态调整策略

### 3. 机械化操作
- **问题**: 严格按照±100操作
- **解决**: 灵活调整阈值

## 优化建议

### 动态参数
```python
# 根据市场波动性动态调整周期
def adaptive_cci_period(volatility):
    if volatility > 1.5:
        return 10  # 高波动用短周期
    elif volatility < 0.8:
        return 20  # 低波动用长周期
    else:
        return 14  # 标准周期
```

### 多时间框架
```python
def multi_timeframe_cci(data):
    cci_14 = calculate_cci(data, 14)
    cci_50 = calculate_cci(data, 50)
    
    # 长短周期同向确认
    if cci_14 > 100 and cci_50 > 0:
        return "强势看涨"
    elif cci_14 < -100 and cci_50 < 0:
        return "强势看跌"
    else:
        return "信号不一致"
```

## 适用场景
- ✅ 趋势跟踪策略
- ✅ 突破交易确认
- ✅ 超买超卖识别
- ✅ 商品期货分析 (原始用途)

## 输出字段
- `CCI_14`: 14日顺势指标
- `CCI_20`: 20日顺势指标
- `TP`: 典型价格
- `CCI_Signal`: CCI信号 (1=看涨, -1=看跌, 0=中性)
- `CCI_Zone`: CCI区域标识 (超买/超卖/中性)
- `CCI_Trend`: CCI趋势方向 