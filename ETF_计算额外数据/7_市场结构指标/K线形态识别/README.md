# K线形态识别 (Candlestick Pattern Recognition)

## 概述
K线形态识别是通过分析单根或多根K线的组合来判断市场心理和未来价格走向的重要技术分析方法。

## 单根K线形态

### 1. 十字星系列 (Doji)
#### 标准十字星
- **特征**: 开盘价 ≈ 收盘价，上下影线较长
- **识别条件**: |开盘价 - 收盘价| ≤ 实体长度 × 0.1
- **市场含义**: 多空力量平衡，转势信号

#### 长腿十字星 (Long-legged Doji)
- **特征**: 上下影线都很长的十字星
- **识别条件**: 影线长度 > 实体的5倍
- **市场含义**: 市场犹豫不决，变盘概率高

#### 蜻蜓十字星 (Dragonfly Doji)
- **特征**: 只有下影线的十字星
- **识别条件**: 上影线 ≤ 实体长度，下影线 > 实体3倍
- **市场含义**: 底部反转信号

#### 墓碑十字星 (Gravestone Doji)
- **特征**: 只有上影线的十字星
- **识别条件**: 下影线 ≤ 实体长度，上影线 > 实体3倍
- **市场含义**: 顶部反转信号

### 2. 锤子线系列 (Hammer)
#### 锤子线 (Hammer)
- **特征**: 小实体，长下影线，上涨趋势中出现
- **识别条件**: 
  - 下影线 ≥ 实体长度 × 2
  - 上影线 ≤ 实体长度 × 0.1
- **市场含义**: 底部反转信号

#### 上吊线 (Hanging Man)
- **特征**: 形态同锤子线，但在下跌趋势末期出现
- **识别条件**: 同锤子线
- **市场含义**: 顶部反转信号

#### 倒锤子线 (Inverted Hammer)
- **特征**: 小实体，长上影线，在下跌趋势末期
- **识别条件**:
  - 上影线 ≥ 实体长度 × 2
  - 下影线 ≤ 实体长度 × 0.1
- **市场含义**: 可能的底部反转

### 3. 纺锤线 (Spinning Top)
- **特征**: 小实体，上下影线相对较长
- **识别条件**: 实体 ≤ (最高价 - 最低价) × 0.3
- **市场含义**: 市场不确定性，需要观察后续

## 双根K线形态

### 1. 吞没形态 (Engulfing Pattern)
#### 看涨吞没 (Bullish Engulfing)
- **特征**: 大阳线完全吞没前一根小阴线
- **识别条件**:
  - 前K线为阴线，当前K线为阳线
  - 当前开盘价 < 前收盘价
  - 当前收盘价 > 前开盘价
- **市场含义**: 强烈的底部反转信号

#### 看跌吞没 (Bearish Engulfing)
- **特征**: 大阴线完全吞没前一根小阳线
- **识别条件**:
  - 前K线为阳线，当前K线为阴线
  - 当前开盘价 > 前收盘价
  - 当前收盘价 < 前开盘价
- **市场含义**: 强烈的顶部反转信号

### 2. 孕线形态 (Harami Pattern)
#### 看涨孕线 (Bullish Harami)
- **特征**: 小阳线完全包含在前一根大阴线内
- **识别条件**: 当前K线的高低点都在前K线实体内
- **市场含义**: 下跌动能减弱，可能反转

#### 看跌孕线 (Bearish Harami)
- **特征**: 小阴线完全包含在前一根大阳线内
- **识别条件**: 当前K线的高低点都在前K线实体内
- **市场含义**: 上涨动能减弱，可能反转

### 3. 包含线形态 (Inside/Outside Bar)
#### 内包线 (Inside Bar)
- **特征**: 当前K线完全包含在前一根K线范围内
- **识别条件**: 
  - 当前最高价 ≤ 前最高价
  - 当前最低价 ≥ 前最低价
- **市场含义**: 市场犹豫，等待突破方向

#### 外包线 (Outside Bar)
- **特征**: 当前K线完全包含前一根K线
- **识别条件**:
  - 当前最高价 ≥ 前最高价
  - 当前最低价 ≤ 前最低价
- **市场含义**: 强势表现，通常延续当前趋势

## 三根K线形态

### 1. 启明星/黄昏星 (Morning/Evening Star)
#### 启明星 (Morning Star)
- **特征**: 大阴线 + 小实体 + 大阳线
- **市场含义**: 强烈的底部反转信号

#### 黄昏星 (Evening Star)
- **特征**: 大阳线 + 小实体 + 大阴线
- **市场含义**: 强烈的顶部反转信号

### 2. 三白兵/三黑鸦 (Three White Soldiers/Three Black Crows)
#### 三白兵 (Three White Soldiers)
- **特征**: 连续三根阳线，逐步上升
- **市场含义**: 强势上涨信号

#### 三黑鸦 (Three Black Crows)
- **特征**: 连续三根阴线，逐步下跌
- **市场含义**: 强势下跌信号

## 输出字段
- `Doji`: 十字星标识
- `Hammer`: 锤子线标识
- `Hanging_Man`: 上吊线标识
- `Engulfing_Bullish`: 看涨吞没标识
- `Engulfing_Bearish`: 看跌吞没标识
- `Inside_Bar`: 内包线标识
- `Outside_Bar`: 外包线标识
- `Morning_Star`: 启明星标识
- `Evening_Star`: 黄昏星标识
- `Pattern_Strength`: 形态强度评分

## 实战应用

### 1. 反转确认
- 在关键支撑/阻力位出现反转形态
- 结合成交量确认有效性
- 等待后续K线确认

### 2. 趋势延续
- 在趋势中段出现延续形态
- 回调后的反转形态
- 突破后的确认形态

### 3. 入场时机
```python
# 示例策略
if pattern == "Bullish_Engulfing" and at_support_level:
    signal = "BUY"
elif pattern == "Bearish_Engulfing" and at_resistance_level:
    signal = "SELL"
```

## 形态可靠性评估

### 高可靠性条件
1. 在关键价位出现
2. 伴随放量确认
3. 符合整体趋势
4. 多个形态共振

### 低可靠性警示
1. 在趋势中段出现
2. 成交量萎缩
3. 与趋势相反
4. 形态不够标准

## 组合分析策略
- **与支撑阻力配合**: 形态 + 位置 = 高胜率
- **与成交量配合**: 放量确认更可靠
- **与其他指标配合**: RSI背离 + 反转形态
- **与趋势线配合**: 突破 + 确认形态

## 风险提示
- 单独依赖K线形态风险较大
- 需要其他指标确认
- 假突破形态需要及时止损
- 市场情绪和基本面也很重要 